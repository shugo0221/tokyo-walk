# Tokyo Walk Randomizer - 要件定義書

**バージョン**: 1.0
**作成日**: 2026年2月8日
**最終更新日**: 2026年2月8日

---

## 1. プロジェクト概要

### 1.1 プロジェクト名
**Tokyo Walk Randomizer（東京散歩ガチャ）**

### 1.2 目的
東京都内の散歩コースをユーザーの現在の状況（季節、気温、天候、所要時間）に基づいて自動提案し、散歩の計画を楽しく簡単にするWebアプリケーション。

### 1.3 対象ユーザー
- 東京都内で散歩を楽しみたい人
- 新しい散歩コースを発見したい人
- 季節や天候に合わせた散歩先を探している人
- 限られた時間で効率的に散歩したい人

### 1.4 主な特徴
- ガチャ形式のランダム選択で新しい発見を提供
- 100種類の厳選された散歩コース
- 季節・天候・時間に応じたフィルタリング
- Google Maps連携による経路案内
- 距離と所要時間の正確な情報提供

---

## 2. 機能要件

### 2.1 コア機能

#### 2.1.1 条件設定機能
**FR-001: 季節選択**
- 選択肢: 春、夏、秋、冬
- デフォルト: 現在の月から自動判定
- 選択時の動作: 対応する平均気温に自動設定
  - 春: 18°C
  - 夏: 28°C
  - 秋: 18°C
  - 冬: 8°C

**FR-002: 気温設定**
- 入力方式: スライダー（-5°C 〜 40°C）
- デフォルト: 20°C（または季節に応じた平均気温）
- 表示: リアルタイムで現在値を表示

**FR-003: 天候選択**
- 選択肢: 晴天、曇天、雨天
- デフォルト: 晴天
- 雨天時: 屋内・アーケード対応コースを優先

**FR-004: 所要時間選択**
- 選択肢: 30分、60分、90分
- デフォルト: 60分
- フィルタリング: 選択した時間のコースのみ表示

#### 2.1.2 コース選択機能
**FR-005: ランダム選択（ガチャ）**
- ボタン: 「散歩コースをガチャる！」
- 動作: 設定条件に合致するコースからランダムに1つ選択
- 条件不一致時: 「条件に合うコースがありません」と表示

**FR-006: 該当コース数表示**
- 表示位置: ガチャボタンの上
- 更新タイミング: 条件変更時にリアルタイム更新
- 表示形式: 「該当コース: X件」

**FR-007: 再抽選機能**
- ボタン: 「🔄 再抽選」
- 動作: 同じ条件で別のコースをランダム選択

#### 2.1.3 コース情報表示
**FR-008: 基本情報表示**
- コース名
- エリア
- 距離（km）
- 所要時間（分）
- 説明文
- 適した季節
- 適した天候

**FR-009: 所要時間の注釈**
- 表示内容: 観光・休憩・写真撮影を含む目安時間の説明
- カスタム注釈: コースごとに個別設定
- デフォルト注釈: 「所要時間は観光・休憩・写真撮影などを含む目安時間です。Google Mapの徒歩時間とは異なる場合があります。」

#### 2.1.4 地図連携機能
**FR-010: Google Maps連携**
- 機能: 「Google Mapで見る」ボタン
- 動作: Google Maps Directions APIを使用して経路表示
- パラメータ:
  - スタート地点
  - ゴール地点
  - 経由地点（waypoints）
  - 移動手段: 徒歩（walking）

**FR-011: 経由地点設定**
- 各コースに1〜3箇所の経由地点を設定
- 目的: 実際の散歩ルートに近い経路を表示
- 経由地点の例: 観光スポット、公園、寺社仏閣など

### 2.2 コースデータ

#### 2.2.1 コース総数
**FR-012: 100コースの提供**
- 合計: 100コース
- 所要時間別内訳:
  - 30分コース: 32個
  - 60分コース: 42個
  - 90分コース: 26個

#### 2.2.2 カテゴリー別内訳
**FR-013: 夜景コース（20コース）**
- レインボーブリッジ、東京タワー、スカイツリーなど
- 対象季節: 通年
- 特徴: イルミネーション、夜景スポット

**FR-014: 季節限定コース（26コース）**
- 春（6コース）: 桜の名所
- 夏（8コース）: 涼散歩、水辺
- 秋（6コース）: 紅葉スポット
- 冬（6コース）: イルミネーション

**FR-015: グルメ散歩コース（8コース）**
- 商店街、食べ歩き、下町グルメ
- 例: 戸越銀座、月島もんじゃ、築地など

**FR-016: 歴史・文化コース（6コース）**
- 寺社仏閣、歴史的建造物
- 例: 浅草寺、増上寺、柴又など

**FR-017: 雨天対応コース（4コース）**
- 地下街、商業施設、屋内施設
- 例: 東京駅地下街、サンシャインシティなど

**FR-018: オールシーズンコース（36コース）**
- 年間を通じて楽しめるコース
- 都心、下町、郊外をバランス良く配置

#### 2.2.3 コースデータ構造
**FR-019: 必須フィールド**
- id: ユニークID（1〜100）
- name: コース名
- duration: 所要時間（30 | 60 | 90）
- distance: 距離（km、小数点第1位まで）
- area: エリア名
- seasons: 適した季節の配列
- weatherStyles: 適した天候の配列
- description: コースの説明文

**FR-020: オプションフィールド**
- startPoint: スタート地点（駅名・場所名）
- endPoint: ゴール地点（駅名・場所名）
- waypoints: 経由地点の配列
- durationNote: 所要時間に関する個別注釈

### 2.3 UI/UX機能

#### 2.3.1 レスポンシブデザイン
**FR-021: マルチデバイス対応**
- デスクトップ
- タブレット
- スマートフォン

#### 2.3.2 アニメーション
**FR-022: インタラクティブなUI**
- ボタンホバーエフェクト
- スケールアニメーション
- フェードイン効果
- シマーエフェクト（ガチャボタン）

#### 2.3.3 カラー・デザイン
**FR-023: グラデーションデザイン**
- メインカラー: Indigo → Purple → Pink
- 背景: グラデーション + ブラー効果
- カード: 半透明 + バックドロップブラー

---

## 3. 非機能要件

### 3.1 パフォーマンス
**NFR-001: 初期表示速度**
- 目標: 2秒以内

**NFR-002: フィルタリング速度**
- 目標: リアルタイム（100ms以内）

**NFR-003: ガチャ実行速度**
- 目標: 即座（50ms以内）

### 3.2 可用性
**NFR-004: 稼働時間**
- 目標: 99.9%以上

**NFR-005: ブラウザ対応**
- Chrome（最新版）
- Safari（最新版）
- Firefox（最新版）
- Edge（最新版）

### 3.3 拡張性
**NFR-006: コース追加**
- 新規コースの追加が容易な設計
- データ構造の拡張性を確保

**NFR-007: 機能追加**
- 将来的な機能追加に対応可能な設計
- コンポーネントベースの実装

### 3.4 保守性
**NFR-008: コードの可読性**
- TypeScriptによる型安全性
- コメントによる説明
- 命名規則の統一

**NFR-009: バージョン管理**
- Gitによる変更履歴の管理
- GitHub Pagesでのホスティング対応

---

## 4. システム構成

### 4.1 技術スタック
**フロントエンド**
- Next.js 16.1.6（React フレームワーク）
- TypeScript
- Tailwind CSS

**開発環境**
- Node.js
- npm

**デプロイ**
- Vercel（推奨）
- GitHub Pages（代替）

### 4.2 ディレクトリ構造
```
tokyo-walk-randomizer/
├── app/
│   ├── page.tsx          # メインページ
│   ├── layout.tsx        # レイアウト
│   └── posts/            # 投稿ページ（将来実装）
├── lib/
│   └── courses.ts        # コースデータと関数
├── public/               # 静的ファイル
├── .env.local.example    # 環境変数のサンプル
├── package.json          # 依存関係
├── tsconfig.json         # TypeScript設定
├── tailwind.config.ts    # Tailwind設定
├── README.md             # プロジェクト説明
├── REQUIREMENTS.md       # 要件定義書（本書）
└── SUPABASE_SETUP.md     # Supabase設定手順
```

### 4.3 主要ファイルの役割

#### 4.3.1 lib/courses.ts
- コースデータの定義
- 型定義（Season, WeatherStyle, Duration, Course）
- ヘルパー関数:
  - `formatDistance()`: 距離のフォーマット
  - `getGoogleMapsUrl()`: Google Maps URLの生成

#### 4.3.2 app/page.tsx
- メインUIコンポーネント
- 状態管理（useState）
- フィルタリングロジック
- イベントハンドラー

---

## 5. データ定義

### 5.1 型定義

#### 5.1.1 Season（季節）
```typescript
type Season = "春" | "夏" | "秋" | "冬";
```

#### 5.1.2 WeatherStyle（天候）
```typescript
type WeatherStyle = "晴天" | "曇天" | "雨天";
```

#### 5.1.3 Duration（所要時間）
```typescript
type Duration = 30 | 60 | 90;
```

#### 5.1.4 Course（コース）
```typescript
interface Course {
  id: number;                    // 1〜100
  name: string;                  // コース名
  duration: Duration;            // 所要時間
  distance: number;              // 距離（km）
  area: string;                  // エリア名
  seasons: Season[];             // 適した季節
  weatherStyles: WeatherStyle[]; // 適した天候
  description: string;           // 説明文
  startPoint?: string;           // スタート地点
  endPoint?: string;             // ゴール地点
  waypoints?: string[];          // 経由地点
  durationNote?: string;         // 所要時間の注釈
}
```

### 5.2 季節ごとの平均気温
```typescript
const seasonTemperatures = {
  "春": 18,  // 3〜5月の平均気温
  "夏": 28,  // 6〜8月の平均気温
  "秋": 18,  // 9〜11月の平均気温
  "冬": 8,   // 12〜2月の平均気温
};
```

---

## 6. ビジネスロジック

### 6.1 コースフィルタリング
**条件**
1. 選択された季節がコースのseasonsに含まれる
2. 選択された天候がコースのweatherStylesに含まれる
3. 選択された所要時間がコースのdurationと一致する

**実装**
```typescript
courses.filter((course) => {
  return (
    course.seasons.includes(currentSeason) &&
    course.weatherStyles.includes(weather) &&
    course.duration === duration
  );
});
```

### 6.2 ランダム選択
**アルゴリズム**
1. フィルタリング後のコース配列を取得
2. 配列の長さをチェック（0の場合は「該当なし」表示）
3. `Math.random()`を使用してランダムインデックスを生成
4. 該当するコースを選択

### 6.3 季節自動判定
**ロジック**
- 現在の月を取得（1〜12）
- 3〜5月: 春
- 6〜8月: 夏
- 9〜11月: 秋
- 12〜2月: 冬

### 6.4 Google Maps URL生成
**パラメータ**
- `api=1`: Google Maps Directions API
- `origin`: スタート地点（エンコード済み）
- `destination`: ゴール地点（エンコード済み）
- `waypoints`: 経由地点（パイプ区切り、エンコード済み）
- `travelmode=walking`: 徒歩モード

---

## 7. 制約事項

### 7.1 技術的制約
**CONS-001: Google Maps API**
- 無料枠の制限あり
- APIキー不要の基本URL使用（制限付き）

**CONS-002: 静的データ**
- コースデータはハードコーディング
- 動的な更新には再デプロイが必要

**CONS-003: オフライン非対応**
- インターネット接続が必須

### 7.2 ビジネス制約
**CONS-004: コース範囲**
- 東京都内のみ
- 23区＋多摩地区が中心

**CONS-005: 更新頻度**
- コースデータの更新は手動
- 季節イベント等のリアルタイム情報は反映されない

### 7.3 ユーザビリティ制約
**CONS-006: 条件の組み合わせ**
- 条件によっては該当コースがゼロの場合あり
- ユーザーが条件を調整する必要がある

---

## 8. 今後の拡張計画

### 8.1 短期的な拡張（Phase 2）
**FUT-001: お気に入り機能**
- コースをお気に入りに保存
- お気に入り一覧の表示

**FUT-002: 履歴機能**
- 過去にガチャしたコースの履歴
- 再度同じコースを選択可能

**FUT-003: SNS共有機能**
- TwitterやLINEでコースをシェア
- OGP画像の自動生成

### 8.2 中期的な拡張（Phase 3）
**FUT-004: ユーザー投稿機能**
- ユーザー独自のコースを投稿
- コミュニティで共有

**FUT-005: レビュー・評価機能**
- コースのレビュー投稿
- 5段階評価

**FUT-006: 写真投稿機能**
- コースの写真をアップロード
- ギャラリー表示

### 8.3 長期的な拡張（Phase 4）
**FUT-007: AI推薦機能**
- ユーザーの好みを学習
- パーソナライズされたコース推薦

**FUT-008: 他地域への展開**
- 大阪、京都、名古屋などへ拡大
- 地域別のコースデータベース

**FUT-009: モバイルアプリ化**
- React Nativeでのネイティブアプリ開発
- GPS連携機能

---

## 9. 用語集

| 用語 | 説明 |
|------|------|
| ガチャ | ランダム選択機能の呼称。ゲーム業界用語に由来 |
| コース | 散歩ルートの単位。スタートからゴールまでの一連の経路 |
| 経由地点 | コースの途中で立ち寄るスポット。Google Mapsのwaypointsに対応 |
| 所要時間 | 散歩に必要な時間。観光・休憩・写真撮影を含む |
| フィルタリング | 条件に基づいてコースを絞り込む処理 |

---

## 10. 変更履歴

| バージョン | 日付 | 変更内容 | 担当者 |
|-----------|------|---------|--------|
| 1.0 | 2026-02-08 | 初版作成。現在の実装内容に基づく要件定義 | Claude |

---

## 11. 承認

| 役割 | 氏名 | 承認日 | 署名 |
|------|------|--------|------|
| プロダクトオーナー | - | - | - |
| 開発責任者 | - | - | - |

---

**文書終了**
